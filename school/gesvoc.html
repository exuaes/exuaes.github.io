<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#431407">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">
  <title>History Vocabulary</title>
  <style>
    :root{
      --bg:#431407;        /* orange-brown */
      --panel:#451a03;     /* dark orange */
      --muted:#fdba74;     /* orange-300 */
      --text:#fff7ed;      /* warm off-white */
      --accent:#fb923c;    /* orange-400 */
      --accent-2:#fed7aa;  /* orange-200 */
      --border:#7c2d12;    /* red-brown */
      --input:#3f1806;
    }
    html,body{height:100%}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#3b0d04 40%,#2c0a03);color:var(--text);font:16px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:1100px;margin:0 auto;padding:14px; padding-left:calc(14px + env(safe-area-inset-left)); padding-right:calc(14px + env(safe-area-inset-right));}

    /* Header */
    header{position:sticky;top:0;background:linear-gradient(180deg,rgba(67,20,7,.95),rgba(67,20,7,.85));backdrop-filter:saturate(1.2) blur(6px);border-bottom:1px solid var(--border);z-index:10}
    header .bar{display:flex;gap:14px;align-items:end;flex-wrap:wrap;padding:14px 0}
    h1{font-size:20px;margin:0;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:12px;margin-top:4px;line-height:1.4}

    /* Search */
    .search{display:flex;gap:10px;align-items:center;width:100%}
    .input{position:relative;flex:1;min-width:0}
    .input input{
      width:100%;
      padding:12px 56px 12px 44px;
      border-radius:12px;
      border:1px solid var(--border);
      background:var(--input);
      color:var(--text);
      outline:none;
      box-shadow:0 0 0 1px rgba(251,146,60,.0) inset;
      transition:box-shadow .2s;
      font-size:16px;
      line-height:1.4;
      -webkit-text-size-adjust:100%;
    }
    .input input:focus{box-shadow:0 0 0 2px rgba(251,146,60,.35) inset}
    .input .icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:.8;pointer-events:none}
    .input .clear{
      position:absolute;right:6px;top:50%;transform:translateY(-50%);
      background:transparent;border:0;color:var(--muted);cursor:pointer;
      font-size:16px;
      padding:12px;
      min-width:44px;min-height:44px;border-radius:10px;
      display:flex;align-items:center;justify-content:center;
    }
    .input .clear:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

    /* Toggle */
    .toggle{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted);flex-wrap:nowrap}
    .toggle select{background:var(--input);border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:10px;font-size:14px;min-width:140px}

    /* Suggestions */
    .suggest{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 4px}
    .pill{border:1px solid var(--border);border-radius:999px;padding:10px 14px;background:var(--input);color:#ffe7c2;cursor:pointer;font-size:13px;white-space:nowrap}
    .pill:hover{border-color:#7c2d12}
    .pill:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

    /* Table */
    .grid{margin-top:14px;border:1px solid var(--border);border-radius:14px;overflow:auto;background:#3f1806}
    table{border-collapse:separate;border-spacing:0;width:100%;table-layout:fixed}
    thead th{background:#5a1f0a;z-index:5;position:sticky;top:0}
    th,td{padding:12px 14px;border-bottom:1px solid var(--border);vertical-align:top;white-space:normal;word-break:break-word;overflow-wrap:break-word;hyphens:auto}
    th{color:#fed7aa;text-align:left;font-weight:600;font-size:13px;letter-spacing:.2px}
    td{font-size:15px}
    tr:nth-child(even) td{background:rgba(255,255,255,.03)}
    .topic{color:#fdba74}
    .word{font-weight:700}

    /* Cards (mobile) */
    .cards{display:none;margin-top:14px;gap:12px;flex-direction:column}
    .card{background:#3f1806;border:1px solid var(--border);border-radius:12px;padding:16px}
    .card-topic{color:#fdba74;font-size:12px;font-weight:600;margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}
    .card-word{font-size:18px;font-weight:700;margin-bottom:8px;line-height:1.3}
    .card-meaning{margin-bottom:12px;line-height:1.5;color:#ffe7c2}

    mark{background:linear-gradient(90deg,var(--accent-2),#fef3c7);color:#111827;border-radius:4px;padding:0 2px;white-space:pre-wrap}

    details{margin-top:18px}
    summary{cursor:pointer;color:#fed7aa;font-size:15px;padding:8px 0}

    .row{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .row input{background:var(--input);border:1px solid var(--border);color:var(--text);padding:10px;border-radius:10px;font-size:14px}
    .row input[type="text"]{min-width:180px;flex:1}
    .row button{background:linear-gradient(90deg,#f97316,#fb923c);border:0;color:#431407;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer;font-size:14px;white-space:nowrap}
    .row button:active{scale:.99}
    .row button:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

    footer{color:var(--muted);font-size:12px;margin:18px 0 40px}
    a{color:#fb923c}
    .count{color:#fed7aa;font-weight:700}

    /* Mobile responsive */
    @media (max-width: 820px){
      header .bar{gap:10px;padding:10px 0}
      h1{font-size:18px}
      .sub{font-size:11px}
      .bar{align-items:flex-start}
      .toggle{order:2;margin-left:auto}
      .search{order:3;width:100%}
      .input input{padding:14px 56px 14px 44px;font-size:16px}
      .suggest{margin:8px 0 2px;gap:6px}
      .pill{padding:8px 12px;font-size:12px}
      .grid{display:none}
      .cards{display:flex}
      .row{flex-direction:column;gap:8px}
      .row input[type="text"]{min-width:auto;width:100%}
      .row button{padding:12px 16px}
      details summary{font-size:14px}
    }

    @media (max-width: 480px){
      .wrap{padding:8px; padding-left:calc(8px + env(safe-area-inset-left)); padding-right:calc(8px + env(safe-area-inset-right));}
      h1{font-size:16px}
      .card{padding:12px}
      .card-word{font-size:16px}
      .toggle{width:100%}
      .toggle select{width:100%}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="bar">
        <div>
          <h1>History Vocabulary</h1>
          <p class="sub">Designed by EY | Powered by GitHubㅣLast Update: 2025.09.03</p>
        </div>
        <div class="toggle">
          <label for="mode">Match:</label>
          <select id="mode">
            <option value="contains">Contains</option>
            <option value="starts">Starts with</option>
          </select>
        </div>
      </div>
      <form class="search" onsubmit="event.preventDefault();">
        <div class="input">
          <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          <input id="q" placeholder="Suche nach Wort oder Bedeutung…" autocomplete="off" enterkeyhint="search" inputmode="text" />
          <button class="clear" title="Clear" id="clear" aria-label="Clear">✕</button>
        </div>
      </form>
      <div id="suggest" class="suggest"></div>
    </div>
  </header>

  <main class="wrap">
    <!-- Desktop table view -->
    <div class="grid">
      <table id="tbl">
        <thead>
          <tr>
            <th style="width:18%">Thema</th>
            <th style="width:22%">Wort / Ausdruck</th>
            <th>Bedeutung</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Mobile card view -->
    <div class="cards" id="cards" role="list"></div>

    <details>
      <summary>Add / Import</summary>
      <div class="row">
        <input type="text" id="topic" placeholder="Thema" />
        <input type="text" id="word" placeholder="Wort / Ausdruck" />
        <input type="text" id="meaning" placeholder="Bedeutung" />
      </div>
      <div class="row">
        <button id="addBtn">Add item</button>
        <button id="exportBtn" title="Download JSON">Export JSON</button>
        <label style="display:inline-flex;gap:8px;align-items:center;cursor:pointer">
          <input type="file" id="file" accept=".json,.csv,.tsv,.txt" style="display:none" />
          <span class="pill">Import JSON/CSV/TSV</span>
        </label>
      </div>
      <p class="sub">Tip: CSV/TSV columns in this order → <code>topic, word, meaning</code></p>
    </details>

    <footer>
      <div>Items: <span id="count" class="count">0</span>. Data is saved to your browser (LocalStorage).</div>
    </footer>
  </main>

<script>
// Utilities
const $ = (sel,root=document)=>root.querySelector(sel);
const $$ = (sel,root=document)=>Array.from(root.querySelectorAll(sel));
const norm = s => (s||"").toLowerCase().normalize("NFKD").replace(/\p{Diacritic}/gu,"");
function highlight(text, q){
  if(!q) return text;
  const t = String(text);
  const nt = norm(t), nq = norm(q);
  const i = nt.indexOf(nq);
  if(i<0) return t;
  return t.slice(0,i) + '<mark>' + t.slice(i,i+q.length) + '</mark>' + t.slice(i+q.length);
}
function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); } }

// Seed data
let DATA = [
  {topic:"History", word:"vast", meaning:"riesengroß"},
  {topic:"History", word:"autocratic ruler", meaning:"der Selbstherrscher"},
  {topic:"History", word:"serfdom", meaning:"die Leibeigenschaft"},
  {topic:"History", word:"riot", meaning:"der (Volks)Aufruhr"},
  {topic:"History", word:"to suppress by force", meaning:"etw. gewaltsam unterdrücken"},
  {topic:"History", word:"discontent", meaning:"die Unzufriedenheit"},
  {topic:"History", word:"entrepreneur", meaning:"der/die Unternehmer/in"},
  {topic:"History", word:"smallholder", meaning:"der Kleinbauer"},
  {topic:"History", word:"to pool sth. together", meaning:"etw. zusammenlegen"},
  {topic:"History", word:"well-to-do", meaning:"der/die Wohlhabende"},
  {topic:"History", word:"to expropriate sb.", meaning:"jdn. enteignen"},
  {topic:"History", word:"planned economy", meaning:"in contrast to a free market economy with free regulation of supply and demand, in a planned economy the government controls all areas of the economy and sets up targets e.g. for industry or farming that have to be reached within a set period of time. This type of economy was favoured by communist and socialist governments. Stalin focused on the development of heavy industry (e.g. production of steel and heavy machinery), as rapid industrialisation was to be the foundation for future growth and defense capabilities against possible/likely attacks by hostile capitalist powers, at the expense of consumer industry (e.g. cloths) and construction industry (e.g. worker housing)."},
  {topic:"History", word:"base target", meaning:"das Mindestziel / die Norm"},
  {topic:"History", word:"cult of personality", meaning:"der Personenkult"},
  {topic:"History", word:"to persecute", meaning:"jdn. verfolgen"},
  {topic:"History", word:"to erase sth.", meaning:"etw. auslöschen"},
  {topic:"History", word:"unarmed", meaning:"unbewaffnet"},
  {topic:"History", word:"concession", meaning:"das Zugeständnis"},
  {topic:"History", word:"to demoralize", meaning:"entkräften"},
  {topic:"History", word:"expenditure", meaning:"die Ausgaben"},
  {topic:"History", word:"rouble", meaning:"der Rubel"},
  {topic:"History", word:"conscription", meaning:"die Einberufung"},
  {topic:"History", word:"to call up", meaning:"einziehen (ins Militär)"},
  {topic:"History", word:"to mutiny", meaning:"meutern"},
  {topic:"History", word:"to open fire on sb.", meaning:"auf jdn. das Feuer eröffnen"},
  {topic:"History", word:"to abdicate", meaning:"abdanken, zurücktreten"},
  {topic:"History", word:"to condemn sth.", meaning:"etw. verdammen"},
  {topic:"History", word:"to recruit sb.", meaning:"jdn. anwerben"},
  {topic:"History", word:"to execute sb.", meaning:"jdn. hinrichten"},
  {topic:"History", word:"re-enactment", meaning:"die Nachstellung"},
  {topic:"History", word:"perception", meaning:"die Wahrnehmung"},
  {topic:"History", word:"Stalinism", meaning:"Stalin was the dictatorial leader of the USSR (1920–1953). This period, in which Stalin ruthlessly killed or imprisoned millions of his opponents, known as Stalinism, is seen by many to be a perversion of the Marxist Leninist ideology. The term is therefore used in a negative way."},
  {topic:"History", word:"collectivization", meaning:"Stalin wanted to modernize the Soviet Union and reform the economy. In process called collectivization peasants were forced to pool their land together and cooperate on collective farms so called kolkhozes."},
  {topic:"History", word:"kolkhozes", meaning:"collective farms that peasants were forced to join during collectivization → die Kolchose, -n"}
];

// Load from localStorage if present
try{
  const saved = localStorage.getItem('history-vocab-data');
  if(saved) DATA = JSON.parse(saved);
}catch{}

// DOM & state
const tbody = $('#tbl tbody');
const cards = $('#cards');
const q = $('#q');
const modeSel = $('#mode');
const suggest = $('#suggest');
const countEl = $('#count');

function save(){ try{ localStorage.setItem('history-vocab-data', JSON.stringify(DATA)); }catch{} }

function renderTable(rows){
  tbody.innerHTML = rows.map(r => {
    const query = q.value.trim();
    return `<tr>
      <td class="topic">${highlight(r.topic||'', query)}</td>
      <td class="word">${highlight(r.word||'', query)}</td>
      <td>${highlight(r.meaning||'', query)}</td>
    </tr>`;
  }).join('');
}

function renderCards(rows){
  const query = q.value.trim();
  cards.innerHTML = rows.map(r => {
    return `<div class="card" role="listitem">
      ${r.topic ? `<div class="card-topic">${highlight(r.topic, query)}</div>` : ''}
      <div class="card-word">${highlight(r.word||'', query)}</div>
      <div class="card-meaning">${highlight(r.meaning||'', query)}</div>
    </div>`;
  }).join('');
}

function render(rows){
  renderTable(rows);
  renderCards(rows);
  if(countEl) countEl.textContent = rows.length;
}

function filter(){
  const query = q.value.trim();
  if(!query){ render(DATA); makeSuggestions(''); return; }
  const nq = norm(query);
  const mode = modeSel.value;
  const rows = DATA.filter(r => {
    const hay = [r.word, r.meaning, r.topic].map(norm);
    if(mode==='starts') return hay.some(x => x.startsWith(nq));
    return hay.some(x => x.includes(nq));
  });
  render(rows);
  makeSuggestions(query);
}

function makeSuggestions(query){
  const nq = norm(query);
  let words = Array.from(new Set(DATA.map(r=>r.word).filter(Boolean)));
  if(!nq){ suggest.innerHTML=''; return; }
  if(nq.length===1){
    words = words.filter(w => norm(w).startsWith(nq)).slice(0,12);
  }else{
    words = words.filter(w => norm(w).includes(nq)).slice(0,12);
  }
  suggest.innerHTML = words.map(w=>`<button class="pill" data-w="${w}" aria-label="Use suggestion ${w}">${w}</button>`).join('');
  $$('#suggest .pill').forEach(b=>b.addEventListener('click',()=>{ q.value=b.dataset.w; filter(); q.focus(); }))
}

const doFilter = debounce(filter, 120);
q.addEventListener('input', doFilter);
modeSel.addEventListener('change', filter);
$('#clear').addEventListener('click', ()=>{ q.value=''; filter(); q.focus(); });

// Add / Export / Import
$('#addBtn').addEventListener('click', ()=>{
  const topic = $('#topic').value.trim();
  const word = $('#word').value.trim();
  const meaning = $('#meaning').value.trim();
  if(!word || !meaning) return alert('Word and meaning are required.');
  DATA.unshift({topic, word, meaning});
  save();
  $('#topic').value = $('#word').value = $('#meaning').value = '';
  filter();
  q.focus();
});

$('#exportBtn').addEventListener('click', ()=>{
  const blob = new Blob([JSON.stringify(DATA, null, 2)], {type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'history-vocab.json';
  a.click();
  URL.revokeObjectURL(a.href);
});

$('#file').addEventListener('change', async (e)=>{
  const f = e.target.files[0]; if(!f) return;
  const text = await f.text();
  let rows = [];
  try{ rows = JSON.parse(text); if(!Array.isArray(rows)) throw 0; }
  catch{
    const lines = text.split(/\r?\n/).filter(Boolean);
    rows = lines.map(line => line.split(/[\t,]/)).map(c=>({ topic:c[0]||'', word:c[1]||'', meaning:c[2]||'' }));
  }
  rows = rows.filter(r => r && r.word && r.meaning);
  DATA = [...rows, ...DATA];
  save();
  filter();
  e.target.value='';
});

// initial render
render(DATA);
</script>
</body>
</html>
